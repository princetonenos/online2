<template>
  <header class="app-header">
    <div class="header-inner">
      <button @click="goBack" aria-label="Back" class="btn-icon">‹</button>
      <button @click="goHome" aria-label="Home" class="logo-btn">
        <img :src="logoSrc" alt="Classroom" class="logo" />
        <span class="title">Classroom</span>
      </button>
    </div>

    <div class="header-right">
      <div class="greeting">Hi, {{ userName }}</div>
      <button @click="openProfile" class="btn-icon">⚙</button>
    </div>
  </header>
</template>

<script setup>
import { computed } from 'vue'
import { useRouter } from 'vue-router'

const router = useRouter()
const currentUser = JSON.parse(localStorage.getItem('mock:currentUser') || 'null')
const userName = computed(() => currentUser?.name || 'User')
const logoSrc = '/logo192.png' // update to your real logo path

const roleToRoute = { admin: 'AdminDashboard', teacher: 'TeacherDashboard', student: 'StudentDashboard' }
function routeExists(name) { try { return router.hasRoute(name) } catch { return false } }

function goBack(){ router.back() }
function goHome(){ const name = roleToRoute[currentUser?.role] || 'Dashboard'; if(routeExists(name)) router.push({ name }); else router.push('/') }
function openProfile(){ if(routeExists('Profile')) router.push({ name: 'Profile' }) }
</script>

<style scoped>
:root { --header-height: 64px; }

.app-header{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--header-height);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 16px;
  background:var(--bg, #fff);
  box-shadow: 0 1px 6px rgba(0,0,0,0.06);
  z-index: 60;
}
.header-inner{ display:flex; align-items:center; gap:12px; }
.logo{ width:36px; height:36px; object-fit:cover; }
.title{ margin-left:8px; font-weight:600; display:inline-block; }
.header-right{ display:flex; align-items:center; gap:12px; }
.btn-icon{ background:transparent; border:0; cursor:pointer; padding:6px; font-size:16px; }
.logo-btn{ display:flex; align-items:center; gap:8px; background:transparent; border:0; cursor:pointer; padding:6px; }
.greeting{ font-size:14px; color:#333; }
</style>
