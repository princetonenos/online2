import{p as R,u as K,a as O,y as Y,D as H,r as T,k as c,o as J,c as o,d as n,e as s,t as r,n as b,h as u,F as _,m as k,j as P,I as M}from"./index-ae66ec3f.js";import{_ as z}from"./AttachmentPreview-1fd7681c.js";const W={key:0,class:"space-y-6"},X={key:1,class:"space-y-6"},Z={class:"bg-white rounded-classroom classroom-shadow p-6"},ss={class:"flex items-start justify-between mb-4"},ts={class:"flex-1"},es={class:"text-2xl font-medium text-classroom-gray-900 mb-2"},as={class:"flex items-center space-x-4 text-sm text-classroom-gray-500"},os={class:"chip chip-primary"},ns={class:"flex items-center space-x-1"},rs={class:"prose max-w-none"},ls={class:"text-classroom-gray-700 whitespace-pre-line"},is={key:0,class:"mt-6"},cs={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ds={key:0,class:"bg-white rounded-classroom classroom-shadow p-6"},us={key:0,class:"space-y-4"},ms={class:"flex items-center justify-between p-4 border border-classroom-gray-200 rounded-classroom"},gs={class:"text-sm text-classroom-gray-500"},ps={key:0,class:"p-4 border border-classroom-gray-200 rounded-classroom"},ys={class:"flex items-center space-x-4"},vs={class:"text-2xl font-medium text-classroom-gray-900"},hs={key:0,class:"flex-1"},xs={class:"text-sm text-classroom-gray-700"},fs={key:1,class:"space-y-3"},bs={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},_s={key:1,class:"space-y-4"},ks={class:"border-2 border-dashed border-classroom-gray-300 rounded-classroom p-6 text-center"},ws={class:"flex items-center justify-end space-x-3"},As=["disabled"],Ss={key:1,class:"bg-white rounded-classroom classroom-shadow p-6"},Cs={class:"space-y-4"},Bs=["onClick"],Is={class:"flex items-center space-x-3"},Ds=["src","alt"],Ts={class:"font-medium text-classroom-gray-900"},Ms={class:"text-sm text-classroom-gray-500"},zs={class:"flex items-center space-x-4"},Es={key:0,class:"text-classroom-gray-900 font-medium"},Fs={key:2,class:"text-center py-12"},qs={__name:"AssignmentDetail",setup(Ls){const w=R();K();const x=O();Y();const m=H(),f=T(!0),p=T([]),y=c(()=>w.params.assignmentId);c(()=>w.params.id);const A=c(()=>x.currentUser),S=c(()=>x.isTeacher),l=c(()=>m.getAssignmentById(y.value)),E=c(()=>m.getSubmissionsByAssignment(y.value)),i=c(()=>m.getSubmissionByUser(y.value,A.value.id)),C=c(()=>p.value.length>0),F=e=>({assignment:"chip-primary",quiz:"chip-secondary",material:"chip-gray",question:"chip-secondary"})[e]||"chip-gray",L=e=>({assignment:"Assignment",quiz:"Quiz",material:"Material",question:"Question"})[e]||"Assignment",B=e=>({assigned:"chip-gray",submitted:"chip-secondary",graded:"chip-primary",missing:"bg-red-100 text-red-800"})[e]||"chip-gray",v=e=>({assigned:"Assigned",submitted:"Turned in",graded:"Graded",missing:"Missing"})[e]||"Assigned",h=e=>x.getUserById(e),$=e=>new Date(e).toLocaleDateString(),j=e=>{Array.from(e.target.files).forEach(a=>{p.value.push({name:a.name,size:U(a.size),type:a.type,file:a})}),e.target.value=""},U=e=>{if(e===0)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],g=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,g)).toFixed(2))+" "+a[g]},q=async()=>{if(C.value)try{await m.submitAssignment(y.value,A.value.id,{files:p.value,status:"submitted"}),d("Assignment submitted successfully"),p.value=[]}catch(e){console.error("Error submitting assignment:",e),d("Error submitting assignment")}},G=()=>{d("Marked as done")},N=()=>{d("Edit assignment functionality would open here")},V=e=>{var t;d(`Opening submission from ${(t=h(e.studentId))==null?void 0:t.name}`)},Q=async()=>{f.value=!0;try{await m.loadAssignments()}catch(e){console.error("Error loading assignment:",e),d("Error loading assignment")}finally{f.value=!1}};J(()=>{Q()});const d=e=>{window.showToast&&window.showToast(e)};return(e,t)=>f.value?(o(),n("div",W,[...t[2]||(t[2]=[s("div",{class:"skeleton h-8 w-3/4"},null,-1),s("div",{class:"skeleton h-4 w-full"},null,-1),s("div",{class:"skeleton h-4 w-2/3"},null,-1),s("div",{class:"skeleton h-32 w-full"},null,-1)])])):l.value?(o(),n("div",X,[s("div",Z,[s("div",ss,[s("div",ts,[s("h1",es,r(l.value.title),1),s("div",as,[s("span",{class:b(["chip",F(l.value.type)])},r(L(l.value.type)),3),s("span",os,r(l.value.points)+" points ",1),s("span",ns,[t[3]||(t[3]=s("span",{class:"material-icons text-base"},"schedule",-1)),s("span",null,"Due "+r($(l.value.dueDate)),1)])])]),S.value?(o(),n("button",{key:0,onClick:N,class:"btn-outline flex items-center space-x-2"},[...t[4]||(t[4]=[s("span",{class:"material-icons text-lg"},"edit",-1),s("span",null,"Edit",-1)])])):u("",!0)]),s("div",rs,[t[5]||(t[5]=s("h3",{class:"text-lg font-medium text-classroom-gray-900 mb-3"},"Instructions",-1)),s("div",ls,r(l.value.description),1)]),l.value.attachments&&l.value.attachments.length>0?(o(),n("div",is,[t[6]||(t[6]=s("h3",{class:"text-lg font-medium text-classroom-gray-900 mb-3"},"Attachments",-1)),s("div",cs,[(o(!0),n(_,null,k(l.value.attachments,a=>(o(),M(z,{key:a.name,attachment:a},null,8,["attachment"]))),128))])])):u("",!0)]),S.value?(o(),n("div",Ss,[t[14]||(t[14]=s("h2",{class:"text-xl font-medium text-classroom-gray-900 mb-4"},"Student submissions",-1)),s("div",Cs,[(o(!0),n(_,null,k(E.value,a=>{var g,I,D;return o(),n("div",{key:a.id,class:"flex items-center justify-between p-4 border border-classroom-gray-200 rounded-classroom hover:border-classroom-primary transition-colors cursor-pointer",onClick:$s=>V(a)},[s("div",Is,[s("img",{src:(g=h(a.studentId))==null?void 0:g.avatar,alt:(I=h(a.studentId))==null?void 0:I.name,class:"w-10 h-10 rounded-full"},null,8,Ds),s("div",null,[s("h3",Ts,r((D=h(a.studentId))==null?void 0:D.name),1),s("p",Ms,r(v(a.status)),1)])]),s("div",zs,[s("span",{class:b(["chip text-sm",B(a.status)])},r(v(a.status)),3),a.grade?(o(),n("span",Es,r(a.grade)+" / "+r(l.value.points),1)):u("",!0),t[13]||(t[13]=s("span",{class:"material-icons text-classroom-gray-400"},"chevron_right",-1))])],8,Bs)}),128))])])):(o(),n("div",ds,[t[12]||(t[12]=s("h2",{class:"text-xl font-medium text-classroom-gray-900 mb-4"},"Your work",-1)),i.value?(o(),n("div",us,[s("div",ms,[s("div",null,[t[7]||(t[7]=s("h3",{class:"font-medium text-classroom-gray-900"},"Status",-1)),s("p",gs,r(v(i.value.status)),1)]),s("span",{class:b(["chip text-sm",B(i.value.status)])},r(v(i.value.status)),3)]),i.value.grade?(o(),n("div",ps,[t[8]||(t[8]=s("h3",{class:"font-medium text-classroom-gray-900 mb-2"},"Grade & Feedback",-1)),s("div",ys,[s("div",vs,r(i.value.grade)+" / "+r(l.value.points),1),i.value.feedback?(o(),n("div",hs,[s("p",xs,r(i.value.feedback),1)])):u("",!0)])])):u("",!0),i.value.files&&i.value.files.length>0?(o(),n("div",fs,[t[9]||(t[9]=s("h3",{class:"font-medium text-classroom-gray-900"},"Submitted files",-1)),s("div",bs,[(o(!0),n(_,null,k(i.value.files,a=>(o(),M(z,{key:a.name,attachment:a},null,8,["attachment"]))),128))])])):u("",!0)])):(o(),n("div",_s,[s("div",ks,[s("input",{type:"file",ref:"fileInput",multiple:"",onChange:j,class:"hidden"},null,544),s("button",{onClick:t[0]||(t[0]=a=>e.$refs.fileInput.click()),class:"btn-primary mb-2"},[...t[10]||(t[10]=[s("span",{class:"material-icons text-lg mr-2"},"upload",-1),P(" Add or create ",-1)])]),t[11]||(t[11]=s("p",{class:"text-sm text-classroom-gray-500"},"Drag and drop files here or click to upload",-1))]),s("div",ws,[s("button",{onClick:G,class:"btn-outline"}," Mark as done "),s("button",{onClick:q,class:"btn-primary",disabled:!C.value}," Turn in ",8,As)])]))]))])):(o(),n("div",Fs,[t[15]||(t[15]=s("div",{class:"w-24 h-24 bg-classroom-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[s("span",{class:"material-icons text-classroom-gray-400 text-4xl"},"error_outline")],-1)),t[16]||(t[16]=s("h2",{class:"text-xl font-medium text-classroom-gray-900 mb-2"},"Assignment not found",-1)),t[17]||(t[17]=s("p",{class:"text-classroom-gray-600 mb-6"},"The assignment you're looking for doesn't exist.",-1)),s("button",{onClick:t[1]||(t[1]=a=>e.$router.back()),class:"btn-primary"}," Go back ")]))}};export{qs as default};
