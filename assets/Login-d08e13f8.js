import{_ as z,u as B,r as l,c as Q,o as W,a as i,b as n,d as b,e as t,w as C,f as _,v as $,n as S,F as Z,g as O,h as c,i as Y,t as m,j as G,k as E}from"./index-d2bf20c5.js";import{u as H}from"./auth-17017921.js";import"./axios-78d57de0.js";const J={class:"min-h-screen flex items-center justify-center p-4 md:p-6 relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"},K={class:"w-full max-w-md bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl p-6 md:p-8 z-10 border border-white/50 transform transition-all duration-300 hover:shadow-3xl max-h-[95vh] overflow-y-auto"},X={class:"space-y-1.5"},ee={class:"relative"},te={class:"space-y-1.5"},se={class:"flex items-center justify-between"},ae={key:0,class:"flex items-center space-x-0.5"},oe={class:"relative"},le=["type"],re={class:"material-icons text-base"},ie={class:"flex items-center justify-between"},ne={class:"flex items-center"},de={key:0,class:"p-2.5 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start space-x-2"},ue={class:"text-xs text-yellow-800"},ce={class:"font-medium"},me={class:"mt-0.5"},ve={key:1,class:"p-2.5 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-2"},fe={class:"text-xs text-red-700 flex-1"},pe=["disabled"],xe={key:0,class:"material-icons animate-spin text-lg"},ge={key:1,class:"material-icons text-lg"},be={class:"text-base"},ye={class:"grid grid-cols-3 gap-2"},he={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50"},we={class:"bg-white rounded-2xl max-w-md w-full p-6 md:p-8 classroom-shadow"},ke={class:"relative"},_e={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start space-x-3"},Se={class:"text-sm text-red-700 flex-1"},Te={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-xl"},Ae={class:"flex gap-3 pt-2"},Ie=["disabled"],Pe=["disabled"],De={key:0,class:"material-icons animate-spin text-lg"},M=5,Ee={__name:"Login",setup(Re){const g=B(),T=H(),d=l({email:"",password:""}),v=l(!1),o=l(""),R=l(!0),y=l(!1),r=l(0),h=l(0),u=l(!1),A=Q(()=>M-r.value);function F(){const a=d.value.password;let e=0;a.length>=8&&e++,/[A-Z]/.test(a)&&/[a-z]/.test(a)&&e++,/[0-9]/.test(a)&&/[^A-Za-z0-9]/.test(a)&&e++,h.value=Math.min(e,3)}const I=l(!1),f=l(""),p=l(!1),x=l(""),w=l(!1),L={admin:"AdminDashboard",teacher:"TeacherDashboard",student:"StudentDashboard"};function k(a){try{return g.hasRoute(a)}catch{return!1}}async function N(){var a;if(u.value){o.value="Account is locked due to too many failed attempts. Please contact support.";return}v.value=!0,o.value="";try{const e=await T.login({email:d.value.email,password:d.value.password});if(!e)throw new Error("Login failed");console.log("Login successful - User:",e,"Role:",e.role),r.value=0,localStorage.removeItem("loginAttempts"),localStorage.removeItem("lockoutTime");const s=L[e.role]||null;if(console.log("Target route:",s,"Route exists:",k(s)),s&&k(s)){console.log("Navigating to:",s),await g.push({name:s});return}if(k("Dashboard")){console.log("Fallback to Dashboard"),await g.push({name:"Dashboard"});return}o.value=`Signed in as ${e.role} but target route missing. Contact admin.`}catch(e){if(console.error("Login error:",e),r.value++,localStorage.setItem("loginAttempts",r.value.toString()),r.value>=M){u.value=!0;const s=Date.now()+15*60*1e3;localStorage.setItem("lockoutTime",s.toString()),o.value="Too many failed attempts. Account locked for 15 minutes."}else(e==null?void 0:e.code)==="ETIMEDOUT"?o.value="Network timeout. Please check your connection and try again.":((a=e==null?void 0:e.response)==null?void 0:a.status)===401?o.value=`Invalid email or password. ${A.value} attempt${A.value!==1?"s":""} remaining.`:o.value=e.message||"Failed to sign in. Please try again."}finally{v.value=!1}}function U(){const a=localStorage.getItem("loginAttempts"),e=localStorage.getItem("lockoutTime");if(a&&(r.value=parseInt(a)),e){const s=Date.now(),D=parseInt(e);if(s<D){u.value=!0;const j=Math.ceil((D-s)/6e4);o.value=`Account locked. Try again in ${j} minute${j!==1?"s":""}.`,setTimeout(()=>{u.value=!1,r.value=0,o.value="",localStorage.removeItem("loginAttempts"),localStorage.removeItem("lockoutTime")},D-s)}else localStorage.removeItem("loginAttempts"),localStorage.removeItem("lockoutTime"),r.value=0}}function q(){I.value=!1,f.value="",x.value="",w.value=!1}async function V(){p.value=!0,x.value="",w.value=!1;try{if(!f.value)throw new Error("Please enter your email address");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.value))throw new Error("Please enter a valid email address");const e=await T.requestPasswordReset(f.value);console.log("Password reset request submitted:",e),w.value=!0,setTimeout(()=>{q()},3e3)}catch(a){console.error("Password reset error:",a),x.value=a.message||"Failed to submit password reset request"}finally{p.value=!1}}async function P(a){if(u.value){o.value="Account is locked. Please wait before trying again.";return}v.value=!0,o.value="";try{const e=await T.quickSignIn(a),s=L[e.role];console.log("Quick login - Role:",a,"User:",e,"Target route:",s),r.value=0,localStorage.removeItem("loginAttempts"),localStorage.removeItem("lockoutTime"),s&&k(s)?(console.log("Navigating to:",s),await g.push({name:s})):(console.log("Target route not found, falling back to Dashboard"),await g.push({name:"Dashboard"}))}catch(e){console.error("Quick sign-in error:",e),o.value="Quick sign-in failed: "+e.message}finally{v.value=!1}}return W(()=>{U()}),(a,e)=>(i(),n("div",J,[e[27]||(e[27]=b('<div class="absolute inset-0 pointer-events-none" data-v-8cdfd032><div class="absolute top-10 left-5 md:left-10 text-blue-200 opacity-30 animate-float-slow" data-v-8cdfd032><span class="material-icons text-4xl md:text-6xl" data-v-8cdfd032>menu_book</span></div><div class="absolute top-20 right-8 md:right-16 text-green-200 opacity-25 animate-float-medium" data-v-8cdfd032><span class="material-icons text-3xl md:text-5xl" data-v-8cdfd032>auto_stories</span></div><div class="absolute bottom-32 left-8 md:left-20 text-purple-200 opacity-20 animate-float-fast" data-v-8cdfd032><span class="material-icons text-2xl md:text-4xl" data-v-8cdfd032>book</span></div><div class="absolute top-40 left-20 md:left-32 text-red-200 opacity-25 animate-float-slow" data-v-8cdfd032><span class="material-icons text-3xl md:text-5xl" data-v-8cdfd032>edit</span></div><div class="absolute bottom-40 right-20 md:right-32 text-yellow-200 opacity-30 animate-float-medium" data-v-8cdfd032><span class="material-icons text-4xl md:text-6xl" data-v-8cdfd032>create</span></div><div class="absolute top-60 right-10 md:right-24 text-indigo-200 opacity-20 animate-float-fast" data-v-8cdfd032><span class="material-icons text-5xl md:text-7xl" data-v-8cdfd032>dashboard</span></div><div class="absolute bottom-20 left-16 md:left-40 text-teal-200 opacity-25 animate-float-slow" data-v-8cdfd032><span class="material-icons text-4xl md:text-6xl" data-v-8cdfd032>assignment</span></div><div class="absolute top-32 right-32 md:right-48 text-pink-200 opacity-30 animate-float-medium" data-v-8cdfd032><span class="material-icons text-4xl md:text-6xl" data-v-8cdfd032>school</span></div><div class="absolute bottom-60 left-32 md:left-48 text-orange-200 opacity-20 animate-float-fast" data-v-8cdfd032><span class="material-icons text-3xl md:text-5xl" data-v-8cdfd032>person</span></div><div class="absolute top-48 left-48 md:left-64 text-cyan-200 opacity-25 animate-float-slow" data-v-8cdfd032><span class="material-icons text-5xl md:text-7xl" data-v-8cdfd032>groups</span></div></div>',1)),t("div",K,[e[19]||(e[19]=b('<div class="text-center mb-6" data-v-8cdfd032><div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl mb-3 shadow-lg transform transition-transform hover:scale-110 duration-300" data-v-8cdfd032><span class="material-icons text-white text-3xl" data-v-8cdfd032>school</span></div><h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-1" data-v-8cdfd032> Welcome Back </h1><p class="text-gray-600 text-xs" data-v-8cdfd032>Sign in to continue your learning journey</p><div class="mt-3 inline-flex items-center space-x-1.5 bg-green-50 px-3 py-1.5 rounded-full border border-green-200" data-v-8cdfd032><span class="material-icons text-green-600 text-xs" data-v-8cdfd032>verified_user</span><span class="text-green-700 text-xs font-medium" data-v-8cdfd032>Secure Login</span></div></div>',1)),t("form",{onSubmit:C(N,["prevent"]),class:"space-y-4"},[t("div",X,[e[10]||(e[10]=t("label",{class:"block text-xs font-medium text-gray-700"},"Email Address",-1)),t("div",ee,[e[9]||(e[9]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"material-icons text-gray-400 text-base"},"email")],-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value.email=s),type:"email",required:"",autocomplete:"email",placeholder:"Enter your email",class:S(["w-full pl-9 pr-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/80 backdrop-blur-sm text-sm",{"border-red-300 focus:ring-red-500 focus:border-red-500":o.value}])},null,2),[[$,d.value.email]])])]),t("div",te,[t("div",se,[e[11]||(e[11]=t("label",{class:"block text-xs font-medium text-gray-700"},"Password",-1)),d.value.password?(i(),n("div",ae,[(i(),n(Z,null,O(3,s=>t("div",{key:s,class:S(["w-5 h-1 rounded-full transition-colors duration-200",h.value>=s?h.value===1?"bg-red-500":h.value===2?"bg-yellow-500":"bg-green-500":"bg-gray-300"])},null,2)),64))])):c("",!0)]),t("div",oe,[e[12]||(e[12]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"material-icons text-gray-400 text-base"},"lock")],-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>d.value.password=s),type:y.value?"text":"password",required:"",autocomplete:"current-password",placeholder:"Enter your password",onInput:F,class:S(["w-full pl-9 pr-11 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/80 backdrop-blur-sm text-sm",{"border-red-300 focus:ring-red-500 focus:border-red-500":o.value}])},null,42,le),[[Y,d.value.password]]),t("button",{type:"button",onClick:e[2]||(e[2]=s=>y.value=!y.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors"},[t("span",re,m(y.value?"visibility_off":"visibility"),1)])])]),t("div",ie,[t("div",ne,[_(t("input",{id:"remember",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=s=>R.value=s),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"},null,512),[[G,R.value]]),e[13]||(e[13]=t("label",{for:"remember",class:"ml-2 text-sm text-gray-700 cursor-pointer select-none hover:text-gray-900"},"Remember me for 30 days",-1))]),t("button",{type:"button",onClick:e[4]||(e[4]=s=>I.value=!0),class:"text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors underline-offset-2 hover:underline"}," Forgot password? ")]),r.value>0?(i(),n("div",de,[e[14]||(e[14]=t("span",{class:"material-icons text-yellow-600 text-base flex-shrink-0 mt-0.5"},"warning",-1)),t("div",ue,[t("p",ce,m(r.value)+" failed attempt"+m(r.value>1?"s":""),1),t("p",me,m(A.value)+" remaining before lockout",1)])])):c("",!0),o.value?(i(),n("div",ve,[e[15]||(e[15]=t("span",{class:"material-icons text-red-500 text-base flex-shrink-0 mt-0.5"},"error",-1)),t("p",fe,m(o.value),1)])):c("",!0),t("button",{disabled:v.value||u.value,class:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white rounded-xl hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 transition-all duration-300 font-semibold shadow-lg hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 transform hover:scale-[1.02] active:scale-[0.98]",type:"submit"},[v.value?(i(),n("span",xe,"autorenew")):u.value?(i(),n("span",ge,"lock")):c("",!0),t("span",be,m(v.value?"Signing in...":u.value?"Account Locked":"Sign In Securely"),1)],8,pe)],32),e[20]||(e[20]=b('<div class="relative my-5" data-v-8cdfd032><div class="absolute inset-0 flex items-center" data-v-8cdfd032><div class="w-full border-t border-gray-200" data-v-8cdfd032></div></div><div class="relative flex justify-center text-xs" data-v-8cdfd032><span class="px-3 bg-white text-gray-500" data-v-8cdfd032>Quick Access</span></div></div>',1)),t("div",ye,[t("button",{onClick:e[5]||(e[5]=s=>P("admin")),class:"px-3 py-2.5 bg-gradient-to-br from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 font-medium text-xs shadow-md hover:shadow-lg transform hover:scale-105"},[...e[16]||(e[16]=[t("span",{class:"material-icons text-xs block mb-0.5"},"admin_panel_settings",-1),E(" Admin ",-1)])]),t("button",{onClick:e[6]||(e[6]=s=>P("teacher")),class:"px-3 py-2.5 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 font-medium text-xs shadow-md hover:shadow-lg transform hover:scale-105"},[...e[17]||(e[17]=[t("span",{class:"material-icons text-xs block mb-0.5"},"school",-1),E(" Teacher ",-1)])]),t("button",{onClick:e[7]||(e[7]=s=>P("student")),class:"px-3 py-2.5 bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all duration-200 font-medium text-xs shadow-md hover:shadow-lg transform hover:scale-105"},[...e[18]||(e[18]=[t("span",{class:"material-icons text-xs block mb-0.5"},"person",-1),E(" Student ",-1)])])])]),I.value?(i(),n("div",he,[t("div",we,[e[25]||(e[25]=b('<div class="text-center mb-6" data-v-8cdfd032><div class="mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4" data-v-8cdfd032><span class="material-icons text-blue-600 text-2xl" data-v-8cdfd032>lock_reset</span></div><h2 class="text-2xl font-bold text-gray-900 mb-2" data-v-8cdfd032>Reset Your Password</h2><p class="text-gray-600" data-v-8cdfd032>Enter your email address and we&#39;ll notify the system administrator to restore your account access.</p></div>',1)),t("form",{onSubmit:C(V,["prevent"]),class:"space-y-4"},[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email Address",-1)),t("div",ke,[e[21]||(e[21]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"material-icons text-gray-400 text-lg"},"email")],-1)),_(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>f.value=s),type:"email",required:"",placeholder:"Enter your registered email",class:S(["w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",{"border-red-300 focus:ring-red-500 focus:border-red-500":x.value}])},null,2),[[$,f.value]])])]),x.value?(i(),n("div",_e,[e[23]||(e[23]=t("span",{class:"material-icons text-red-500 text-lg flex-shrink-0 mt-0.5"},"error",-1)),t("p",Se,m(x.value),1)])):c("",!0),w.value?(i(),n("div",Te,[...e[24]||(e[24]=[t("div",{class:"flex items-center space-x-3"},[t("span",{class:"material-icons text-green-500 text-lg"},"check_circle"),t("div",null,[t("p",{class:"text-sm font-medium text-green-800"},"Request Submitted Successfully"),t("p",{class:"text-sm text-green-700 mt-1"},"The system administrator has been notified and will contact you shortly to restore your account access.")])],-1)])])):c("",!0),t("div",Ae,[t("button",{type:"button",onClick:q,class:"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200 font-medium",disabled:p.value}," Cancel ",8,Ie),t("button",{type:"submit",disabled:p.value,class:"flex-1 py-3 px-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[p.value?(i(),n("span",De,"autorenew")):c("",!0),t("span",null,m(p.value?"Submitting...":"Submit Request"),1)],8,Pe)])],32),e[26]||(e[26]=b('<div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl" data-v-8cdfd032><div class="flex items-start space-x-3" data-v-8cdfd032><span class="material-icons text-blue-500 text-lg flex-shrink-0 mt-0.5" data-v-8cdfd032>info</span><div class="text-sm text-blue-700" data-v-8cdfd032><p class="font-medium" data-v-8cdfd032>What happens next?</p><p class="mt-1" data-v-8cdfd032>The system administrator will review your request and contact you via email to verify your identity and restore your account access.</p></div></div></div>',1))])])):c("",!0)]))}},Ce=z(Ee,[["__scopeId","data-v-8cdfd032"],["__file","/Users/mac/Development/startups/online2/src/views/shared/Login.vue"]]);export{Ce as default};
