import{r as f,c as p,_ as T,a as c,b as g,e,k as $,t as v,h as y,F as E,g as z,n as C,G as D,o as F,x as B,y as V,m as _,f as q,v as G,C as R,l as M,D as x}from"./index-e0178975.js";import{u as j}from"./auditLog-0bddef16.js";import{e as O}from"./exportHelpers-5714f3fc.js";import{E as Q}from"./ErrorAlert-602817cc.js";import{L as H}from"./LoadingSpinner-b40f773f.js";import"./auth-385be275.js";import"./axios-78d57de0.js";/* empty css                                                                   *//* empty css                                                                       */function J(a=10){const r=f(1),s=f(a),l=f(0),m=p(()=>Math.ceil(l.value/s.value)),P=p(()=>r.value<m.value),b=p(()=>r.value>1),w=p(()=>(r.value-1)*s.value),h=p(()=>Math.min(w.value+s.value,l.value)),i=u=>!u||!Array.isArray(u)?[]:(l.value=u.length,u.slice(w.value,h.value)),N=()=>{P.value&&r.value++},U=()=>{b.value&&r.value--},S=u=>{u>=1&&u<=m.value&&(r.value=u)},k=()=>{r.value=1},I=p(()=>{const u=[];let t=Math.max(1,r.value-Math.floor(2.5)),d=Math.min(m.value,t+5-1);d-t<5-1&&(t=Math.max(1,d-5+1));for(let o=t;o<=d;o++)u.push(o);return u});return{currentPage:r,perPage:s,totalItems:l,totalPages:m,hasNextPage:P,hasPreviousPage:b,startIndex:w,endIndex:h,pageNumbers:I,paginate:i,nextPage:N,previousPage:U,goToPage:S,reset:k}}const K={key:0,class:"flex items-center justify-between border-t border-classroom-gray-200 bg-white px-4 py-3 sm:px-6 rounded-b-classroom"},W={class:"flex flex-1 justify-between sm:hidden"},X=["disabled"],Y=["disabled"],Z={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},ee={class:"text-sm text-classroom-gray-700"},te={class:"font-medium"},se={class:"font-medium"},oe={class:"font-medium"},ae={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},re=["disabled"],le={key:1,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-classroom-gray-700 ring-1 ring-inset ring-classroom-gray-300"},ne=["onClick"],ie={key:2,class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-classroom-gray-700 ring-1 ring-inset ring-classroom-gray-300"},ue=["disabled"],de={__name:"PaginationControls",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},totalItems:{type:Number,required:!0},startIndex:{type:Number,required:!0},endIndex:{type:Number,required:!0},pageNumbers:{type:Array,required:!0},hasNextPage:{type:Boolean,required:!0},hasPreviousPage:{type:Boolean,required:!0}},emits:["previous","next","goto"],setup(a){return(r,s)=>a.totalPages>1?(c(),g("div",K,[e("div",W,[e("button",{onClick:s[0]||(s[0]=l=>r.$emit("previous")),disabled:!a.hasPreviousPage,class:"relative inline-flex items-center rounded-md border border-classroom-gray-300 bg-white px-4 py-2 text-sm font-medium text-classroom-gray-700 hover:bg-classroom-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,X),e("button",{onClick:s[1]||(s[1]=l=>r.$emit("next")),disabled:!a.hasNextPage,class:"relative ml-3 inline-flex items-center rounded-md border border-classroom-gray-300 bg-white px-4 py-2 text-sm font-medium text-classroom-gray-700 hover:bg-classroom-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Y)]),e("div",Z,[e("div",null,[e("p",ee,[s[6]||(s[6]=$(" Showing ",-1)),e("span",te,v(a.startIndex+1),1),s[7]||(s[7]=$(" to ",-1)),e("span",se,v(a.endIndex),1),s[8]||(s[8]=$(" of ",-1)),e("span",oe,v(a.totalItems),1),s[9]||(s[9]=$(" results ",-1))])]),e("div",null,[e("nav",ae,[e("button",{onClick:s[2]||(s[2]=l=>r.$emit("previous")),disabled:!a.hasPreviousPage,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-classroom-gray-400 ring-1 ring-inset ring-classroom-gray-300 hover:bg-classroom-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed"},[...s[10]||(s[10]=[e("span",{class:"sr-only"},"Previous",-1),e("span",{class:"material-icons text-sm"},"chevron_left",-1)])],8,re),a.pageNumbers[0]>1?(c(),g("button",{key:0,onClick:s[3]||(s[3]=l=>r.$emit("goto",1)),class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-classroom-gray-900 ring-1 ring-inset ring-classroom-gray-300 hover:bg-classroom-gray-50 focus:z-20 focus:outline-offset-0"}," 1 ")):y("",!0),a.pageNumbers[0]>2?(c(),g("span",le," ... ")):y("",!0),(c(!0),g(E,null,z(a.pageNumbers,l=>(c(),g("button",{key:l,onClick:m=>r.$emit("goto",l),class:C(["relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-classroom-gray-300 focus:z-20 focus:outline-offset-0",l===a.currentPage?"z-10 bg-classroom-primary text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-classroom-primary":"text-classroom-gray-900 hover:bg-classroom-gray-50"])},v(l),11,ne))),128)),a.pageNumbers[a.pageNumbers.length-1]<a.totalPages-1?(c(),g("span",ie," ... ")):y("",!0),a.pageNumbers[a.pageNumbers.length-1]<a.totalPages?(c(),g("button",{key:3,onClick:s[4]||(s[4]=l=>r.$emit("goto",a.totalPages)),class:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-classroom-gray-900 ring-1 ring-inset ring-classroom-gray-300 hover:bg-classroom-gray-50 focus:z-20 focus:outline-offset-0"},v(a.totalPages),1)):y("",!0),e("button",{onClick:s[5]||(s[5]=l=>r.$emit("next")),disabled:!a.hasNextPage,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-classroom-gray-400 ring-1 ring-inset ring-classroom-gray-300 hover:bg-classroom-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed"},[...s[11]||(s[11]=[e("span",{class:"sr-only"},"Next",-1),e("span",{class:"material-icons text-sm"},"chevron_right",-1)])],8,ue)])])])])):y("",!0)}},ce=T(de,[["__file","/home/buddy/GCO/src/components/PaginationControls.vue"]]),me={class:"p-6"},ge={class:"flex items-center justify-between mb-6"},xe={class:"flex items-center space-x-3"},ve={class:"bg-white rounded-classroom classroom-shadow"},pe={class:"p-4 border-b border-classroom-gray-100"},ye={class:"flex items-center space-x-4"},fe={class:"relative flex-1 max-w-md"},be={key:1,class:"overflow-x-auto"},he={class:"w-full"},Pe={class:"px-4 py-3"},we={class:"flex items-center space-x-3"},$e=["src","alt"],Ne={class:"font-medium text-classroom-gray-900"},ke={class:"text-sm text-classroom-gray-500"},Ce={class:"px-4 py-3"},Ue={class:"px-4 py-3 text-classroom-gray-900"},Se={class:"px-4 py-3"},Ie={class:"px-4 py-3"},Le={class:"flex items-center space-x-2"},Ve=["onClick"],Ae={key:2,class:"p-12 text-center"},_e={__name:"UsersList",setup(a){const r=f(""),s=f(""),l=f(!1),m=f(null),P=j(),b=D(),w=p(()=>b.users),h=p(()=>{let n=w.value||[];if(r.value){const t=r.value.toLowerCase();n=n.filter(d=>{var o,L,A;return((o=d.name)==null?void 0:o.toLowerCase().includes(t))||((L=d.email)==null?void 0:L.toLowerCase().includes(t))||((A=d.role)==null?void 0:A.toLowerCase().includes(t))})}return s.value&&(n=n.filter(t=>t.role===s.value)),n}),i=J(10),N=p(()=>i.paginate(h.value)),U=n=>{switch(n){case"admin":return"chip-primary";case"teacher":return"chip-secondary";case"student":return"chip-success";default:return"chip-gray"}},S=async n=>{const t=n.status,d=n.status==="active"?"inactive":"active";try{await b.updateUser(n.id,{status:d}),P.logUserUpdated(n.id,{status:{from:t,to:d}}),u(`User ${d==="active"?"activated":"deactivated"}`)}catch{m.value="Failed to update user status"}},k=async()=>{l.value=!0,m.value=null;try{await b.loadFromStorage()}catch(n){m.value="Failed to load users. Please try again.",console.error("Error loading users:",n)}finally{l.value=!1}},I=()=>{try{const n=h.value.map(t=>({Name:t.name,Email:t.email,Role:t.role,School:t.school||"N/A",Status:t.status}));O(n,"users-export.csv"),P.logDataExport("users",n.length),u("Users exported successfully")}catch{m.value="Failed to export users"}};F(()=>{k()});const u=n=>{window.showToast&&window.showToast(n)};return(n,t)=>{const d=B("router-link");return c(),g("div",me,[e("div",ge,[t[5]||(t[5]=e("h1",{class:"text-2xl font-medium text-classroom-gray-900"},"Users",-1)),e("div",xe,[e("button",{onClick:I,class:"btn-outline flex items-center space-x-2"},[...t[3]||(t[3]=[e("span",{class:"material-icons"},"download",-1),e("span",null,"Export",-1)])]),V(d,{to:"/admin/users/create",class:"btn-primary flex items-center space-x-2"},{default:_(()=>[...t[4]||(t[4]=[e("span",{class:"material-icons"},"add",-1),e("span",null,"Create User",-1)])]),_:1})])]),V(Q,{error:m.value,retry:!0,onDismiss:t[0]||(t[0]=o=>m.value=null),onRetry:k},null,8,["error"]),e("div",ve,[e("div",pe,[e("div",ye,[e("div",fe,[q(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.value=o),type:"text",placeholder:"Search users...",class:"w-full pl-10 pr-4 py-2 border border-classroom-gray-300 rounded-classroom focus:border-classroom-primary focus:outline-none transition-colors"},null,512),[[G,r.value]]),t[6]||(t[6]=e("span",{class:"material-icons absolute left-3 top-1/2 transform -translate-y-1/2 text-classroom-gray-400"}," search ",-1))]),q(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value=o),class:"px-3 py-2 border border-classroom-gray-300 rounded-classroom focus:border-classroom-primary focus:outline-none"},[...t[7]||(t[7]=[e("option",{value:""},"All Roles",-1),e("option",{value:"admin"},"Admin",-1),e("option",{value:"teacher"},"Teacher",-1),e("option",{value:"student"},"Student",-1)])],512),[[R,s.value]])])]),l.value?(c(),M(H,{key:0,message:"Loading users..."})):!l.value&&N.value.length>0?(c(),g("div",be,[e("table",he,[t[9]||(t[9]=e("thead",{class:"bg-classroom-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-sm font-medium text-classroom-gray-900"},"User"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-classroom-gray-900"},"Role"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-classroom-gray-900"},"School"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-classroom-gray-900"},"Status"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-classroom-gray-900"},"Actions")])],-1)),e("tbody",null,[(c(!0),g(E,null,z(N.value,o=>(c(),g("tr",{key:o.id,class:"border-b border-classroom-gray-100 hover:bg-classroom-gray-50 transition-colors"},[e("td",Pe,[e("div",we,[e("img",{src:o.avatar,alt:o.name,class:"w-8 h-8 rounded-full"},null,8,$e),e("div",null,[e("p",Ne,v(o.name),1),e("p",ke,v(o.email),1)])])]),e("td",Ce,[e("span",{class:C(["chip",U(o.role)])},v(o.role),3)]),e("td",Ue,v(o.school||"N/A"),1),e("td",Se,[e("span",{class:C(["chip",o.status==="active"?"chip-success":"chip-warning"])},v(o.status),3)]),e("td",Ie,[e("div",Le,[V(d,{to:`/admin/users/${o.id}/edit`,class:"btn-outline text-xs px-2 py-1"},{default:_(()=>[...t[8]||(t[8]=[$(" Edit ",-1)])]),_:1},8,["to"]),e("button",{onClick:L=>S(o),class:C(["btn-outline text-xs px-2 py-1",o.status==="active"?"text-red-600":"text-green-600"])},v(o.status==="active"?"Deactivate":"Activate"),11,Ve)])])]))),128))])])])):l.value?y("",!0):(c(),g("div",Ae,[...t[10]||(t[10]=[e("span",{class:"material-icons text-6xl text-classroom-gray-300 mb-4"},"people_outline",-1),e("p",{class:"text-classroom-gray-500"},"No users found",-1)])])),!l.value&&h.value.length>0?(c(),M(ce,{key:3,"current-page":x(i).currentPage.value,"total-pages":x(i).totalPages.value,"total-items":x(i).totalItems.value,"start-index":x(i).startIndex.value,"end-index":x(i).endIndex.value,"page-numbers":x(i).pageNumbers.value,"has-next-page":x(i).hasNextPage.value,"has-previous-page":x(i).hasPreviousPage.value,onPrevious:x(i).previousPage,onNext:x(i).nextPage,onGoto:x(i).goToPage},null,8,["current-page","total-pages","total-items","start-index","end-index","page-numbers","has-next-page","has-previous-page","onPrevious","onNext","onGoto"])):y("",!0)])])}}},Re=T(_e,[["__file","/home/buddy/GCO/src/views/admin/UsersList.vue"]]);export{Re as default};
