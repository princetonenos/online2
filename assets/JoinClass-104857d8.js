import{_ as I,u as B,r as m,a as v,b,e,d as C,t as i,w as M,f as T,v as E,n as f,h as w}from"./index-d2bf20c5.js";import{a as k}from"./axios-78d57de0.js";const V={class:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-6"},D={class:"max-w-2xl mx-auto"},O={key:0,class:"bg-white rounded-2xl shadow-xl border border-green-200 p-8 text-center"},P={class:"text-gray-600 mb-4"},$={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},z={class:"text-lg font-semibold text-blue-600"},K={class:"text-sm text-gray-500"},L={key:1,class:"bg-white rounded-2xl shadow-xl border border-gray-100 p-8"},R={class:"mb-6"},X={class:"flex items-center"},Y={class:"flex flex-col sm:flex-row gap-3"},q=["disabled"],G={key:0,class:"material-icons animate-spin mr-2"},H={__name:"JoinClass",setup(F){const h="http://localhost:3000/api/v1",g=B(),c=m(""),o=m(""),a=m(""),d=m(!1),x=m(!1),r=m(null);function S(l){return JSON.parse(localStorage.getItem("mock:classes")||"[]").find(n=>n.code&&String(n.code).toUpperCase()===String(l).toUpperCase()||String(n.id)===String(l))}async function j(){var _;if(!c.value.trim()){a.value="err",o.value="Please enter a class code";return}d.value=!0,o.value="";const l=JSON.parse(localStorage.getItem("mock:currentUser")||"null");if(!l||l.role!=="student"){a.value="err",o.value="You must be signed in as a student to join a class",d.value=!1;return}const t=c.value.trim().toUpperCase();let n=!1;try{const s=localStorage.getItem("auth:token");if(s){await k.post(`${h}/classes/join`,{code:t},{headers:{Authorization:`Bearer ${s}`}}),n=!0;try{const u=(((_=(await k.get(`${h}/classes`,{headers:{Authorization:`Bearer ${s}`}})).data)==null?void 0:_.data)||[]).find(U=>String(U.code).toUpperCase()===t);u&&(r.value={id:u.id,title:u.name||u.title||"Class",subject:u.subject||"",level:u.section||""})}catch{}}}catch{}if(!n&&!r.value){await new Promise(p=>setTimeout(p,300));const s=S(t);if(!s){a.value="err",o.value="Class not found. Please check the code and try again",d.value=!1;return}if(s.students=s.students||[],!s.students.includes(l.id)){s.students.push(l.id);const p=JSON.parse(localStorage.getItem("mock:classes")||"[]").map(y=>y.id===s.id?s:y);localStorage.setItem("mock:classes",JSON.stringify(p))}r.value=s}a.value="ok",o.value="Successfully joined!",x.value=!0,d.value=!1}function J(){window.dispatchEvent(new CustomEvent("classJoined")),g.push("/student/classes").catch(()=>{g.push({name:"StudentClasses"})})}function A(){x.value=!1,r.value=null,c.value="",o.value="",a.value=""}function N(){g.back()}return(l,t)=>(v(),b("div",V,[e("div",D,[t[8]||(t[8]=C('<div class="mb-8 text-center" data-v-d9864cbd><div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4" data-v-d9864cbd><span class="material-icons text-white text-4xl" data-v-d9864cbd>school</span></div><h1 class="text-3xl font-bold text-gray-900 mb-2" data-v-d9864cbd>Join a Class</h1><p class="text-gray-600" data-v-d9864cbd>Enter the class code provided by your teacher</p></div>',1)),x.value&&r.value?(v(),b("div",O,[t[3]||(t[3]=e("div",{class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},[e("span",{class:"material-icons text-green-600 text-3xl"},"check_circle")],-1)),t[4]||(t[4]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-2"},"Successfully Joined!",-1)),e("p",P,"You've joined "+i(r.value.title),1),e("div",$,[t[1]||(t[1]=e("div",{class:"text-sm text-gray-600 mb-1"},"Class Details",-1)),e("div",z,i(r.value.title),1),e("div",K,i(r.value.subject||"General")+" â€¢ "+i(r.value.level||"All Levels"),1)]),e("div",{class:"flex justify-center gap-3"},[e("button",{onClick:J,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-classroom transition-all duration-200 shadow-lg transform hover:scale-105 flex items-center space-x-2"},[...t[2]||(t[2]=[e("span",{class:"material-icons text-sm"},"school",-1),e("span",null,"View My Classes",-1)])]),e("button",{onClick:A,class:"px-6 py-3 border border-gray-300 text-gray-700 rounded-classroom hover:bg-gray-50 transition-colors"}," Join Another ")])])):(v(),b("div",L,[e("form",{onSubmit:M(j,["prevent"])},[e("div",R,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Class Code ",-1)),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>c.value=n),required:"",type:"text",class:f(["w-full p-4 text-lg border-2 border-gray-300 rounded-classroom focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all uppercase tracking-wider text-center font-bold",{"border-red-500":o.value&&a.value==="err"}]),placeholder:"e.g., MAT-X7K9"},null,2),[[E,c.value]]),t[6]||(t[6]=e("p",{class:"text-sm text-gray-500 mt-2 text-center"}," Enter the code exactly as provided by your teacher ",-1))]),o.value?(v(),b("div",{key:0,class:f(["mb-6 p-4 rounded-classroom",a.value==="ok"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"])},[e("div",X,[e("span",{class:f(["material-icons text-sm mr-2",a.value==="ok"?"text-green-600":"text-red-600"])},i(a.value==="ok"?"check_circle":"error"),3),e("span",{class:f(["text-sm font-medium",a.value==="ok"?"text-green-800":"text-red-800"])},i(o.value),3)])],2)):w("",!0),e("div",Y,[e("button",{type:"submit",disabled:!c.value.trim()||d.value,class:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white rounded-classroom transition-all duration-200 shadow-lg transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none font-semibold flex items-center justify-center"},[d.value?(v(),b("span",G,"refresh")):w("",!0),e("span",null,i(d.value?"Joining...":"Join Class"),1)],8,q),e("button",{type:"button",onClick:N,class:"px-6 py-3 border border-gray-300 text-gray-700 rounded-classroom hover:bg-gray-50 transition-colors"}," Cancel ")])],32),t[7]||(t[7]=C('<div class="mt-8 pt-6 border-t border-gray-200" data-v-d9864cbd><h4 class="text-sm font-semibold text-gray-900 mb-3" data-v-d9864cbd>Need Help?</h4><div class="space-y-2 text-sm text-gray-600" data-v-d9864cbd><div class="flex items-start" data-v-d9864cbd><span class="material-icons text-blue-500 text-sm mr-2 mt-0.5" data-v-d9864cbd>info</span><span data-v-d9864cbd>Class codes are typically 7-8 characters (e.g., MAT-X7K9)</span></div><div class="flex items-start" data-v-d9864cbd><span class="material-icons text-blue-500 text-sm mr-2 mt-0.5" data-v-d9864cbd>info</span><span data-v-d9864cbd>Make sure you&#39;re entering the code exactly as shared by your teacher</span></div><div class="flex items-start" data-v-d9864cbd><span class="material-icons text-blue-500 text-sm mr-2 mt-0.5" data-v-d9864cbd>info</span><span data-v-d9864cbd>Contact your teacher if you&#39;re having trouble joining</span></div></div></div>',1))]))])]))}},Z=I(H,[["__scopeId","data-v-d9864cbd"],["__file","/Users/mac/Development/startups/online2/src/views/student/JoinClass.vue"]]);export{Z as default};
