function d(t,r="export.csv",o=null){if(!t||t.length===0)throw new Error("No data to export");const n=o||Object.keys(t[0]),e=[n.join(","),...t.map(s=>n.map(l=>{const c=s[l];if(c==null)return"";const i=String(c);return i.includes(",")||i.includes('"')||i.includes(`
`)?`"${i.replace(/"/g,'""')}"`:i}).join(","))].join(`
`);u(e,r,"text/csv")}function f(t){const r=t.split(`
`).filter(e=>e.trim());if(r.length<2)throw new Error("CSV file must have at least a header row and one data row");const o=a(r[0]);return r.slice(1).map(e=>{const s=a(e),l={};return o.forEach((c,i)=>{l[c]=s[i]||""}),l})}function a(t){const r=[];let o="",n=!1;for(let e=0;e<t.length;e++){const s=t[e],l=t[e+1];s==='"'?n&&l==='"'?(o+='"',e++):n=!n:s===","&&!n?(r.push(o.trim()),o=""):o+=s}return r.push(o.trim()),r}function u(t,r,o){const n=new Blob([t],{type:o}),e=window.URL.createObjectURL(n),s=document.createElement("a");s.href=e,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(e)}function h(t){return new Promise((r,o)=>{const n=new FileReader;n.onload=e=>r(e.target.result),n.onerror=e=>o(new Error("Failed to read file")),n.readAsText(t)})}export{d as e,f as i,h as r};
